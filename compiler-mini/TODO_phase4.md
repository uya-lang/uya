# 阶段4：实现词法分析器（Lexer）

## 4.1 Token 类型定义

- [x] 创建 `src/lexer.h`
  - [x] 定义 TokenType 枚举（仅包含最小子集需要的 Token）
    - [x] 基础：EOF、IDENTIFIER、NUMBER、布尔字面量
    - [x] 关键字：struct、const、var、fn、return、if、else、while、true、false
    - [x] 运算符：+、-、*、/、%、==、!=、<、>、<=、>=、&&、||、!
    - [x] 标点符号：(、)、{、}、;、,、=、.、:
  - [x] 定义 Token 结构体（值、行号、列号等）
  - [x] 添加中文注释说明

## 4.2 Lexer 结构定义

- [x] 在 `src/lexer.h` 中定义 Lexer 结构体
  - [x] 源代码缓冲区（固定大小数组，1MB）
  - [x] 当前位置、行号、列号
  - [x] 文件名（存储在 Arena 中）
  - [x] 添加中文注释说明

## 4.3 Lexer 核心实现（TDD）

### TDD Red: 编写测试

- [x] 创建测试文件
  - [x] 测试 `lexer_init()` 初始化功能
  - [x] 测试标识符识别
  - [x] 测试关键字识别
  - [x] 测试数字识别
  - [x] 测试运算符识别
  - [x] 测试标点符号识别
  - [x] 测试空白字符跳过
  - [x] 测试注释跳过
  - [x] 测试 EOF Token

### TDD Green: 实现功能

- [x] 创建 `src/lexer.c`
  - [x] 实现 `lexer_init()` - 初始化 Lexer（使用固定大小缓冲区）
  - [x] 实现 `lexer_next_token()` - 获取下一个 Token
  - [x] 实现标识符和关键字识别
  - [x] 实现数字字面量识别
  - [x] 实现运算符和标点符号识别
  - [x] 实现注释处理（`//` 单行注释）
  - [x] 实现空白字符跳过
  - [x] 所有字符串存储在 Arena 中
  - [x] 添加中文注释说明
  - [x] 运行测试确保通过
  - [x] **验证函数 < 200 行，文件 < 1500 行**

### TDD Refactor: 优化

- [x] 代码审查和重构
- [x] 运行测试确保通过

## 4.4 Lexer 测试

- [x] 创建测试用例验证 Lexer 功能
- [x] 测试基本 Token 识别
- [x] 测试关键字识别
- [x] 测试数字识别
- [x] 测试运算符识别
- [x] 所有测试通过（9 个测试用例）

