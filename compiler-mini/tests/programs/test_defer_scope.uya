// defer 绑定到当前作用域；嵌套块内层 defer 先于外层执行
// 规范 §9：return 时先计算返回值，再 defer。此处 a=10，return 0 表示通过。
fn main() i32 {
    var a: i32 = 0;
    var b: i32 = 0;
    defer { a = 1; }       // 外层：函数返回时执行
    {
        defer { b = 1; }   // 内层：离开内层块时执行
        a = 10;
    }                     // 离开内层：执行 b=1
    if (b != 1) { return 1; }
    return 0;             // 先计算 0，再 defer(a=1)，返回 0
}
