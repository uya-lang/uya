// sizeof byte 和 FFI 指针类型测试程序
// 测试 sizeof(byte)、sizeof(*byte)、sizeof([byte: 10])、sizeof(&[byte: 10]) 等

fn main() i32 {
    // 测试1：sizeof(byte) - byte 类型大小
    const byte_size: i32 = sizeof(byte);
    if byte_size != 1 {
        return 1;  // byte 应该是 1 字节
    }
    
    // 测试2：sizeof(*byte) - FFI 指针类型大小（64位平台为 8 字节）
    const ffi_byte_ptr_size: i32 = sizeof(*byte);
    if ffi_byte_ptr_size != 8 {
        return 2;  // FFI 指针应该是 8 字节（64位平台）
    }
    
    // 测试3：sizeof([byte: 10]) - byte 数组类型大小
    const byte_array_size: i32 = sizeof([byte: 10]);
    if byte_array_size != 10 {
        return 3;  // [byte: 10] 应该是 10 字节（10 * 1）
    }
    
    // 测试4：sizeof([byte: N]) - 不同大小的 byte 数组类型
    const byte_array_5_size: i32 = sizeof([byte: 5]);
    if byte_array_5_size != 5 {
        return 4;  // [byte: 5] 应该是 5 字节（5 * 1）
    }
    
    const byte_array_100_size: i32 = sizeof([byte: 100]);
    if byte_array_100_size != 100 {
        return 5;  // [byte: 100] 应该是 100 字节（100 * 1）
    }
    
    // 测试5：byte 变量 sizeof
    var byte_var: byte = 42;
    const byte_var_size: i32 = sizeof(byte_var);
    if byte_var_size != 1 {
        return 6;  // byte 变量应该是 1 字节
    }
    
    // 测试6：byte 数组变量 sizeof
    var byte_arr: [byte: 10] = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    const byte_arr_size: i32 = sizeof(byte_arr);
    if byte_arr_size != 10 {
        return 7;  // [byte: 10] 数组应该是 10 字节（10 * 1）
    }
    
    // 测试7：sizeof(&[byte: 10]) - 指向数组类型的指针大小
    const byte_array_ptr_size: i32 = sizeof(&[byte: 10]);
    if byte_array_ptr_size != 8 {
        return 8;  // 指向数组的指针应该是 8 字节（64位平台）
    }
    
    // 测试8：比较 sizeof(*byte) 和 sizeof(&byte) - 应该相同（都是指针）
    const normal_byte_ptr_size: i32 = sizeof(&byte);
    if normal_byte_ptr_size != 8 {
        return 9;  // 普通指针应该是 8 字节
    }
    if ffi_byte_ptr_size != normal_byte_ptr_size {
        return 10;  // FFI 指针和普通指针大小应该相同
    }
    if byte_array_ptr_size != normal_byte_ptr_size {
        return 11;  // 指向数组的指针和普通指针大小应该相同
    }
    
    // 测试9：sizeof 在表达式中的使用
    const calculated_size: i32 = sizeof(byte) * 10;
    if calculated_size != 10 {
        return 12;  // sizeof(byte) * 10 应该是 10
    }
    
    const ptr_array_size: i32 = sizeof(*byte) * 5;
    if ptr_array_size != 40 {
        return 13;  // sizeof(*byte) * 5 应该是 40（5 * 8）
    }
    
    // 测试10：验证指向数组的指针大小和数组大小不同
    if byte_array_ptr_size == byte_array_size {
        return 14;  // 指针大小（8字节）应该不等于数组大小（10字节）
    }
    
    // 所有测试通过
    return 0;
}

