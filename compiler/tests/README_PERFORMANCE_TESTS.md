# 编译器性能测试程序

本目录包含用于测试 Uya 编译器性能的大型测试程序。

## 生成大型测试程序

使用 `generate_large_test.py` 脚本生成大型测试程序：

```bash
# 生成包含 1000 个函数和 100 个结构体的测试程序（默认）
python3 generate_large_test.py

# 自定义参数
python3 generate_large_test.py [函数数量] [结构体数量] [输出文件名]

# 示例：生成 2000 个函数和 200 个结构体
python3 generate_large_test.py 2000 200 large_test.uya
```

## 测试程序说明

生成的测试程序包含：

1. **结构体定义**：多个结构体，每个包含多个字段
2. **辅助函数**：基础的数学运算函数
3. **大量函数**：每个函数包含：
   - 参数和局部变量
   - 函数调用
   - 循环语句
   - 条件语句
   - 结构体使用
4. **主函数**：调用多个测试函数

## 性能测试结果

### large_performance_test.uya
- **函数数量**: 2000
- **结构体数量**: 200
- **文件大小**: 460KB
- **代码行数**: ~20,600 行
- **编译时间**: ~0.057 秒
- **生成的IR指令**: ~2,200 条

## 建议的测试规模

- **小型测试**: 100-500 个函数，用于快速验证
- **中型测试**: 1000-2000 个函数，用于常规性能测试
- **大型测试**: 2000-3000 个函数，用于压力测试（注意内存限制）

超过 3000 个函数可能会导致内存问题。

## 运行性能测试

```bash
# 编译测试程序
time ./uyac tests/large_performance_test.uya output.c

# 查看生成的代码
wc -l output.c
```

