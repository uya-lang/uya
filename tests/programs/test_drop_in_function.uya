// 测试 drop/RAII：全局函数内局部变量离开作用域时调用 drop（规范 §12）
// 预期：main 返回 0（foo 返回时 s 的 drop 被调用一次）

var drop_count: i32 = 0;

struct S {
  id: i32,
  fn drop(self: S) void {
    drop_count = drop_count + 1;
  }
}

fn foo() void {
  const s: S = S{ id: 42 };
}

fn main() i32 {
  foo();
  if drop_count != 1 {
    return 1;
  }
  return 0;
}
